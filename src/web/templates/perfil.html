<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MusicGraph Recommender - Tu perfil musical y recomendaciones personalizadas">
    <title>MusicGraph | Tu Perfil Musical</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Spotify-inspired color scheme */
            --primary: #1DB954;
            --primary-hover: #1ed760;
            --primary-light: rgba(29, 185, 84, 0.1);
            --secondary: #1ed760;
            --gradient-bg: linear-gradient(135deg, #121212 0%, #181818 100%);
            --card-bg: rgba(30, 30, 30, 0.7);
            --card-border: rgba(40, 40, 40, 0.7);
            --card-hover-bg: rgba(40, 40, 40, 0.8);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-tertiary: rgba(255, 255, 255, 0.5);
            --nav-bg: rgba(0, 0, 0, 0.8);
            
            /* Profile types colors - Spotify inspired */
            --profile-especialista: #1DB954;
            --profile-explorador: #1ed760;
            --profile-mainstream: #2E77D0;
            --profile-variado: #F59B23;
            
            /* Shadows */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 16px 32px rgba(0, 0, 0, 0.5);
            
            /* Animations */
            --transition-fast: 0.2s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            
            /* Blur effects */
            --blur-effect: blur(20px);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--gradient-bg);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            background-attachment: fixed;
            scroll-behavior: smooth;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: var(--blur-effect);
            -webkit-backdrop-filter: var(--blur-effect);
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }
        
        .navbar-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 24px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .navbar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }
        
        .navbar-logo-icon {
            font-size: 1.5rem;
            color: var(--primary);
            filter: drop-shadow(0 0 8px rgba(29, 185, 84, 0.5));
        }
        
        .navbar-logo-text {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .navbar-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .navbar-btn {
            background: var(--primary);
            color: black;
            border: none;
            padding: 10px 16px;
            border-radius: 500px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(29, 185, 84, 0.3);
            text-decoration: none;
        }
        
        .navbar-btn:hover {
            transform: scale(1.05);
            background: var(--primary-hover);
            box-shadow: 0 6px 16px rgba(29, 185, 84, 0.4);
        }
        
        /* Header */
        .profile-header {
            padding: 140px 0 60px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header-bg {
            position: absolute;
            top: -50%;
            left: -20%;
            width: 140%;
            height: 200%;
            background: radial-gradient(circle at center, rgba(29, 185, 84, 0.15) 0%, rgba(29, 185, 84, 0) 70%);
            z-index: -1;
            animation: pulse 15s infinite alternate;
        }
        
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: black;
            box-shadow: var(--shadow-md);
            animation: fadeInDown 1s var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .profile-avatar::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to right,
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(255, 255, 255, 0) 100%
            );
            transform: rotate(30deg);
            animation: shimmer 4s infinite;
        }
        
        .profile-name {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 8px;
            animation: fadeIn 1.2s var(--transition-normal);
        }
        
        .profile-type {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 500px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 16px;
            text-transform: uppercase;
            animation: fadeIn 1.4s var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .profile-type::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to right,
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(255, 255, 255, 0) 100%
            );
            animation: shimmer 3s infinite;
        }
        
        .profile-type-especialista {
            background-color: rgba(29, 185, 84, 0.2);
            color: var(--profile-especialista);
        }
        
        .profile-type-explorador {
            background-color: rgba(30, 215, 96, 0.2);
            color: var(--profile-explorador);
        }
        
        .profile-type-mainstream {
            background-color: rgba(46, 119, 208, 0.2);
            color: var(--profile-mainstream);
        }
        
        .profile-type-variado {
            background-color: rgba(245, 155, 35, 0.2);
            color: var(--profile-variado);
        }
        
        .profile-type-desconocido {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }
        
        .profile-bio {
            max-width: 600px;
            margin: 0 auto 40px;
            color: var(--text-secondary);
            animation: fadeInUp 1.6s var(--transition-normal);
        }
        
        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: 8px;
            border: 1px solid var(--card-border);
            padding: 40px;
            margin-bottom: 48px;
            backdrop-filter: var(--blur-effect);
            -webkit-backdrop-filter: var(--blur-effect);
            box-shadow: var(--shadow-md);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            animation: fadeIn 1s var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(29, 185, 84, 0.1), transparent 70%);
            z-index: -1;
        }
        
        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-header {
            margin-bottom: 32px;
        }
        
        .card-title {
            font-size: 1.75rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title-icon {
            color: var(--primary);
        }
        
        .card-description {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        /* Genres */
        .genres-container {
            margin-top: 32px;
        }
        
        .genre-item {
            background: rgba(40, 40, 40, 0.7);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all var(--transition-normal);
            border: 1px solid var(--card-border);
            animation: fadeInUp 0.6s var(--transition-normal);
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
        }
        
        .genre-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .genre-item:nth-child(2) {
            animation-delay: 0.1s;
        }
        
        .genre-item:nth-child(3) {
            animation-delay: 0.2s;
        }
        
        .genre-item:nth-child(4) {
            animation-delay: 0.3s;
        }
        
        .genre-item:nth-child(5) {
            animation-delay: 0.4s;
        }
        
        .genre-item:hover {
            background: var(--card-hover-bg);
            transform: translateX(8px);
            padding-left: 20px;
        }
        
        .genre-item:hover::after {
            opacity: 1;
        }
        
        .genre-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .genre-name {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .genre-percentage {
            font-size: 0.9rem;
            color: var(--text-secondary);
            background: rgba(40, 40, 40, 0.7);
            padding: 4px 8px;
            border-radius: 500px;
        }
        
        .genre-bar-container {
            height: 6px;
            background: rgba(40, 40, 40, 0.7);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }
        
        .genre-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 3px;
            position: absolute;
            top: 0;
            left: 0;
            transition: width 1.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        
        /* Additional Data */
        .data-list {
            margin-top: 24px;
        }
        
        .data-item {
            background: rgba(40, 40, 40, 0.7);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all var(--transition-normal);
            border: 1px solid var(--card-border);
            animation: fadeInUp 0.6s var(--transition-normal);
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .data-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .data-item:nth-child(2) {
            animation-delay: 0.1s;
        }
        
        .data-item:nth-child(3) {
            animation-delay: 0.2s;
        }
        
        .data-item:hover {
            background: var(--card-hover-bg);
            transform: translateX(8px);
            padding-left: 20px;
        }
        
        .data-item:hover::after {
            opacity: 1;
        }
        
        .data-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .data-icon svg {
            width: 20px;
            height: 20px;
            color: var(--primary);
        }
        
        .data-content {
            flex: 1;
        }
        
        .data-label {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 4px;
        }
        
        .data-value {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .insights {
            margin-top: 24px;
            padding: 16px;
            background: rgba(40, 40, 40, 0.5);
            border-radius: 8px;
            border: 1px solid var(--card-border);
        }
        
        .insights-title {
            font-size: 1.1rem;
            margin-bottom: 12px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .insights-title svg {
            color: var(--primary);
        }
        
        .insights-text {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        /* Listening History */
        .history-list {
            margin-top: 24px;
        }

        .history-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border-radius: 8px;
            background: rgba(40, 40, 40, 0.7);
            margin-bottom: 12px;
            transition: all var(--transition-normal);
            animation: fadeInUp 0.6s var(--transition-normal);
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
        }
        
        .history-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: var(--primary);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .history-item:nth-child(2) {
            animation-delay: 0.1s;
        }
        
        .history-item:nth-child(3) {
            animation-delay: 0.2s;
        }
        
        .history-item:nth-child(4) {
            animation-delay: 0.3s;
        }
        
        .history-item:nth-child(5) {
            animation-delay: 0.4s;
        }

        .history-item:hover {
            background: var(--card-hover-bg);
            transform: translateX(5px);
            padding-left: 20px;
        }
        
        .history-item:hover::after {
            opacity: 1;
        }

        .history-cover {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            object-fit: cover;
            box-shadow: var(--shadow-sm);
            transition: transform var(--transition-normal);
        }
        
        .history-item:hover .history-cover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .history-info {
            flex: 1;
        }

        .history-title {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        .history-artist {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .history-time {
            color: var(--text-tertiary);
            font-size: 0.8rem;
            white-space: nowrap;
            background: rgba(40, 40, 40, 0.7);
            padding: 4px 8px;
            border-radius: 500px;
        }
        
        /* Forms */
        form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        label {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
        }
        
        .form-helper {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-top: 4px;
        }
        
        input[type="text"] {
            padding: 16px;
            border-radius: 8px;
            border: 1px solid var(--card-border);
            background: rgba(40, 40, 40, 0.7);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all var(--transition-normal);
            font-family: inherit;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(29, 185, 84, 0.25);
        }
        
        input[type="text"]::placeholder {
            color: var(--text-tertiary);
        }
        
        .btn {
            background: var(--primary);
            color: black;
            border: none;
            padding: 16px 24px;
            border-radius: 500px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(29, 185, 84, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: all 0.6s;
        }
        
        .btn:hover {
            background: var(--primary-hover);
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(29, 185, 84, 0.4);
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* Alert */
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: fadeIn 0.8s var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .alert::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        .alert-info {
            background: rgba(46, 119, 208, 0.1);
            border: 1px solid rgba(46, 119, 208, 0.3);
            color: #2E77D0;
        }
        
        .alert-warning {
            background: rgba(245, 155, 35, 0.1);
            border: 1px solid rgba(245, 155, 35, 0.3);
            color: #F59B23;
        }
        
        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        
        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: var(--blur-effect);
            -webkit-backdrop-filter: var(--blur-effect);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid rgba(29, 185, 84, 0.1);
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 40px 0;
            border-top: 1px solid rgba(40, 40, 40, 0.7);
            color: var(--text-tertiary);
            font-size: 0.9rem;
            margin-top: 40px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .footer-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at bottom center, rgba(29, 185, 84, 0.05), transparent 70%);
            z-index: -1;
        }
        
        .footer-content {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .footer-logo {
            font-weight: 700;
            color: var(--text-secondary);
            margin-bottom: 8px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .navbar-container {
                padding: 12px 16px;
            }
            
            .profile-header {
                padding: 120px 0 40px;
            }
            
            .profile-name {
                font-size: 2rem;
            }
            
            .card {
                padding: 30px;
                margin-bottom: 36px;
            }
            
            .card-title {
                font-size: 1.5rem;
            }
            
            .recommendation-list {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 16px;
            }
            
            .navbar-logo-text {
                font-size: 1.2rem;
            }
            
            .profile-avatar {
                width: 100px;
                height: 100px;
                font-size: 2.5rem;
            }
            
            .profile-name {
                font-size: 1.75rem;
            }
            
            .card {
                padding: 24px;
                border-radius: 8px;
            }
            
            .btn {
                padding: 14px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <!-- Navbar -->
    <nav class="navbar" role="navigation">
        <div class="navbar-container">
            <a href="/" class="navbar-logo" aria-label="MusicGraph Home">
                <span class="navbar-logo-icon" aria-hidden="true">🎧</span>
                <span class="navbar-logo-text">MusicGraph</span>
            </a>
            <div class="navbar-actions">
                <a href="/" class="navbar-btn" aria-label="Volver a la página principal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    <span>Inicio</span>
                </a>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <header class="profile-header">
            <div class="header-bg" aria-hidden="true"></div>
            
            <div class="profile-avatar" aria-hidden="true">
                🎵
            </div>
            
            <h1 class="profile-name">Tu Perfil Musical</h1>
            
            {% if perfil_info.perfil %}
            <div class="profile-type profile-type-{{ perfil_info.perfil }}">
                {{ perfil_info.perfil|upper }}
            </div>
            
            <p class="profile-bio">
                {% if perfil_info.perfil == 'especialista' %}
                Eres un especialista musical. Te gusta profundizar en pocos géneros y conocerlos a fondo. Prefieres calidad sobre cantidad y disfrutas explorando artistas dentro de tus géneros favoritos.
                {% elif perfil_info.perfil == 'explorador' %}
                Eres un explorador musical. Te encanta descubrir nuevos géneros y artistas constantemente. Tu curiosidad te lleva a experimentar con sonidos diversos y a mantener tu biblioteca musical siempre fresca.
                {% elif perfil_info.perfil == 'mainstream' %}
                Tienes un gusto mainstream. Disfrutas de la música popular y las tendencias actuales. Te mantienes al día con los éxitos del momento y prefieres artistas reconocidos.
                {% elif perfil_info.perfil == 'variado' %}
                Tienes un gusto musical variado. Disfrutas de diferentes géneros según tu estado de ánimo o contexto. Tu biblioteca musical es diversa pero con preferencias claras.
                {% else %}
                Aún no tenemos suficiente información para determinar tu perfil musical con precisión. Sigue utilizando MusicGraph para obtener un análisis más detallado.
                {% endif %}
            </p>
            {% endif %}
        </header>
        
        <main>
            {% if perfil_info.mensaje %}
            <div class="alert alert-info">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="16" x2="12" y2="12"></line>
                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
                <span>{{ perfil_info.mensaje }}</span>
            </div>
            {% endif %}
            
            <!-- Análisis de Géneros -->
            {% if perfil_info.generos_principales and perfil_info.generos_principales|length > 0 %}
            <section class="card" aria-labelledby="genres-title" id="genres-section">
                <div class="card-header">
                    <h2 class="card-title" id="genres-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-title-icon" aria-hidden="true">
                            <path d="M2 9a7 7 0 1 0 14 0a7 7 0 1 0-14 0"></path>
                            <path d="M16 11a7 7 0 1 0 14 0a7 7 0 1 0-14 0"></path>
                        </svg>
                        Tus Géneros Principales
                    </h2>
                    <p class="card-description">Análisis de tus preferencias musicales basado en tu historial de escucha</p>
                </div>
                
                <div class="genres-container">
                    {% for genero in perfil_info.generos_principales %}
                    <div class="genre-item" style="animation-delay: {{ loop.index0 * 0.1 }}s">
                        <div class="genre-header">
                            <div class="genre-name">{{ genero.genero }}</div>
                            <div class="genre-percentage">{{ genero.porcentaje }}%</div>
                        </div>
                        <div class="genre-bar-container">
                            <div class="genre-bar" style="width: {{ genero.porcentaje }}%"></div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <div class="insights">
                    <h3 class="insights-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        ¿Qué significa esto?
                    </h3>
                    <p class="insights-text">
                        Los géneros mostrados representan tus preferencias musicales más fuertes. Un porcentaje alto en un género específico indica que dedicas una parte significativa de tu tiempo de escucha a ese estilo musical. Esta información es útil para entender tus gustos y para que MusicGraph pueda ofrecerte recomendaciones más precisas.
                    </p>
                </div>
            </section>

            <!-- Historial de Escucha -->
            {% if perfil_info.historial_escucha %}
            <section class="card" aria-labelledby="history-title">
                <div class="card-header">
                    <h2 class="card-title" id="history-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-title-icon" aria-hidden="true">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        Tu Historial de Escucha
                    </h2>
                    <p class="card-description">Las últimas canciones que has escuchado en Spotify</p>
                </div>
                
                <div class="history-list">
                    {% for item in perfil_info.historial_escucha %}
                    <div class="history-item" style="animation-delay: {{ loop.index0 * 0.1 }}s">
                        <img src="{{ item.image|default('/placeholder.svg?height=60&width=60') }}" alt="Portada del álbum" class="history-cover">
                        <div class="history-info">
                            <div class="history-title">{{ item.title }}</div>
                            <div class="history-artist">{{ item.artist }}</div>
                        </div>
                        <div class="history-time">{{ item.time }}</div>
                    </div>
                    {% endfor %}
                </div>
                
                <div class="insights">
                    <h3 class="insights-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        ¿Cómo se usa esta información?
                    </h3>
                    <p class="insights-text">
                        Tu historial reciente nos ayuda a entender tus preferencias actuales. Estas canciones influyen en las recomendaciones que recibes, especialmente para descubrir música nueva que se alinee con tus gustos del momento. Cuanto más escuchas, más precisas serán tus recomendaciones.
                    </p>
                </div>
            </section>
            {% endif %}
            
            <!-- Datos Adicionales -->
            {% if perfil_info.extra %}
            <section class="card" aria-labelledby="extra-data-title">
                <div class="card-header">
                    <h2 class="card-title" id="extra-data-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-title-icon" aria-hidden="true">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                            <line x1="12" y1="22.08" x2="12" y2="12"></line>
                        </svg>
                        Datos Adicionales
                    </h2>
                    <p class="card-description">Información complementaria sobre tus hábitos musicales</p>
                </div>
                
                <div class="data-list">
                    <div class="data-item">
                        <div class="data-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <div class="data-content">
                            <div class="data-label">Artista más escuchado</div>
                            <div class="data-value">{{ perfil_info.extra.artista_top }}</div>
                        </div>
                    </div>
                    
                    <div class="data-item">
                        <div class="data-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12"></path>
                                <circle cx="17" cy="7" r="5"></circle>
                            </svg>
                        </div>
                        <div class="data-content">
                            <div class="data-label">Popularidad media</div>
                            <div class="data-value">{{ perfil_info.extra.popularidad_media }}</div>
                        </div>
                    </div>
                    
                    <div class="data-item">
                        <div class="data-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M2 9a7 7 0 1 0 14 0a7 7 0 1 0-14 0"></path>
                                <path d="M16 11a7 7 0 1 0 14 0a7 7 0 1 0-14 0"></path>
                            </svg>
                        </div>
                        <div class="data-content">
                            <div class="data-label">Total de géneros distintos</div>
                            <div class="data-value">{{ perfil_info.extra.generos_distintos }}</div>
                        </div>
                    </div>
                </div>
                
                <div class="insights">
                    <h3 class="insights-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        Interpretación de tus datos
                    </h3>
                    <p class="insights-text">
                        {% if perfil_info.extra.generos_distintos > 10 %}
                        Con {{ perfil_info.extra.generos_distintos }} géneros distintos en tu historial, muestras una gran diversidad musical. Tu artista más escuchado es {{ perfil_info.extra.artista_top }}, lo que indica una preferencia consistente. Tu popularidad media de {{ perfil_info.extra.popularidad_media }} sugiere que {% if perfil_info.extra.popularidad_media > 70 %}te inclinas hacia artistas más conocidos y populares{% elif perfil_info.extra.popularidad_media > 40 %}balanceas entre artistas populares y menos conocidos{% else %}tiendes a descubrir artistas menos mainstream y más de nicho{% endif %}.
                        {% else %}
                        Con {{ perfil_info.extra.generos_distintos }} géneros en tu historial, muestras un enfoque más especializado en tus gustos musicales. Tu artista más escuchado es {{ perfil_info.extra.artista_top }}, lo que refleja una fuerte preferencia. Tu popularidad media de {{ perfil_info.extra.popularidad_media }} indica que {% if perfil_info.extra.popularidad_media > 70 %}prefieres artistas reconocidos y populares{% elif perfil_info.extra.popularidad_media > 40 %}escuchas una mezcla equilibrada de artistas conocidos y emergentes{% else %}te atraen artistas menos comerciales y más independientes{% endif %}.
                        {% endif %}
                    </p>
                </div>
            </section>
            {% endif %}
            
            {% else %}
            <!-- Formulario para analizar perfil -->
            <section class="card" aria-labelledby="analyze-title">
                <div class="card-header">
                    <h2 class="card-title" id="analyze-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-title-icon" aria-hidden="true">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.3-4.3"></path>
                        </svg>
                        Analizar Tu Perfil
                    </h2>
                    <p class="card-description">Ingresa tu ID de Spotify para analizar tus preferencias musicales</p>
                </div>
                
                <form id="profileForm" method="POST" action="/perfil" aria-label="Formulario de análisis de perfil">
                    <div class="form-group">
                        <label for="user_id">Tu Spotify ID:</label>
                        <input 
                            type="text" 
                            id="user_id" 
                            name="user_id" 
                            placeholder="Ej: spotify:user:tu_id o simplemente tu_id" 
                            required
                            value="{{ user_id or '' }}"
                        >
                        <p id="id-helper" class="form-helper">Encuentra tu ID en la configuración de tu cuenta de Spotify</p>
                    </div>
                    
                    <button type="submit" class="btn">
                        <span>Analizar mi perfil</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M5 12h14"></path>
                            <path d="m12 5 7 7-7 7"></path>
                        </svg>
                    </button>
                </form>
                
                <div class="insights">
                    <h3 class="insights-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        ¿Qué obtendrás?
                    </h3>
                    <p class="insights-text">
                        Al analizar tu perfil, MusicGraph examinará tu historial de escucha para identificar tus géneros favoritos, artistas más escuchados y patrones musicales. Con esta información, podremos clasificar tu perfil musical y ofrecerte recomendaciones personalizadas basadas en tus gustos reales y en las preferencias de usuarios con perfiles similares al tuyo.
                    </p>
                </div>
            </section>
            {% endif %}
        </main>
    </div>
    
    <footer>
        <div class="footer-bg" aria-hidden="true"></div>
        <div class="footer-content">
            <div class="footer-logo">
                <span aria-hidden="true">🎧</span> MusicGraph
            </div>
            <p>© 2025 MusicGraph Recommender | Descubre nueva música con el poder de los grafos y la similitud de usuarios</p>
        </div>
    </footer>
    
    <script>
        // Animate genre bars on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Fix for genre bars animation con reflow forzado
            setTimeout(function() {
                const bars = document.querySelectorAll('.genre-bar');
                bars.forEach((bar, index) => {
                    const width = bar.getAttribute('data-width');
                    if (width) {
                        bar.style.width = '0%'; // Reset inicial
                        bar.offsetWidth;        // ⬅️ Forzar reflow
                        setTimeout(() => {
                            bar.style.width = width;
                        }, index * 100);        // Animación escalonada
                    }
                });
            }, 300);

            
            // AJAX form submission
            const profileForm = document.getElementById('profileForm');
            if (profileForm) {
                profileForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    loadingOverlay.classList.add('active');
                    
                    const formData = new FormData(profileForm);
                    
                    fetch('/perfil', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Error en la respuesta del servidor');
                        }
                        return response.text();
                    })
                    .then(html => {
                        // Reemplazar el contenido de la página con la respuesta
                        document.documentElement.innerHTML = html;
                        
                        // Ejecutar scripts después de reemplazar el contenido
                        const scripts = document.querySelectorAll('script');
                        scripts.forEach(script => {
                            if (script.innerHTML) {
                                eval(script.innerHTML);
                            }
                        });
                        
                        // Scroll al inicio de la página
                        window.scrollTo(0, 0);
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('Ha ocurrido un error al procesar tu solicitud. Por favor, intenta de nuevo.');
                    })
                    .finally(() => {
                        loadingOverlay.classList.remove('active');
                    });
                });
            }
        });
        
        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.background = 'rgba(0, 0, 0, 0.95)';
                navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.3)';
            } else {
                navbar.style.background = 'var(--nav-bg)';
                navbar.style.boxShadow = 'var(--shadow-sm)';
            }
        });
        
        // Parallax effect for header background
        window.addEventListener('scroll', function() {
            const headerBg = document.querySelector('.header-bg');
            if (headerBg) {
                const scrollPosition = window.scrollY;
                headerBg.style.transform = `translateY(${scrollPosition * 0.3}px)`;
            }
        });
    </script>
</body>
</html>